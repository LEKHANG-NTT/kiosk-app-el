<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Friendly AI UI</title>

<style>
:root {
    --bg: #0c1220;
    --primary: #6ee7ff;
    --accent: #a5f3fc;
    --glow: rgba(110,231,255,.7);
}

* { box-sizing: border-box; }

html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at top, #16203a, var(--bg));
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: "Inter","Segoe UI",sans-serif;
    color: white;
    overflow: hidden;
}

/* ===== CONTAINER ===== */
.ai {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 34px;
}

/* ===== FACE ===== */
.face {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
    animation: face-breath 2s ease-in-out infinite;
}

/* ===== EYEBROWS ===== */
.brows {
    display: flex;
    gap: 70px;
}

.brow {
    width: 84px;
    height: 10px;
    border-radius: 20px;
    background: linear-gradient(80deg, var(--accent), var(--primary));
    opacity: .85;
    animation: brow-happy 2s ease-in-out infinite;
}

.brow.right { animation-delay: .1s; }

/* ===== EYES ===== */
.eyes {
    display: flex;
    gap: 60px;
}

.eye {
    width: 96px;
    height: 96px;
    border-radius: 40%;
    background:
        radial-gradient(circle at 100% 10%, #ffffff 0%, #dffaff 35%, var(--primary) 50%);
    box-shadow:
        0 0 22px var(--glow),
        inset 0 0 18px rgba(255,255,255,.9);
    position: relative;
    animation:
        eye-float 1s ease-in-out infinite,
        blink 2s infinite;
}

.eye::after {
    content: "";
    position: absolute;
    inset: 26%;
    border-radius: 50%;
    background: radial-gradient(circle, #0c1220 0%, #0c1220 60%, transparent 70%);
    animation: pupil-happy 3s ease-in-out infinite;
}

/* ===== MOUTH ===== */
.mouth {
    width: 92px;
    height: 42px;
    border-bottom: 6px solid var(--primary);
    border-radius: 0 0 100px 100px;
    box-shadow: 0 10px 20px var(--glow);
    animation: mouth-happy 4s ease-in-out infinite;
}

/* ===== SYNCING / THINKING ===== */
.syncing .eye::after {
    inset: 32%;
}

.syncing .mouth {
    width: 32px;
    border-radius: 8px;
    animation: none;
}

/* ===== TEXT ===== */
.status {
    font-size: 13px;
    letter-spacing: 4px;
    color: var(--accent);
    opacity: .65;
}

.loading-text {
    animation: pulse-text 1.5s infinite;
}

h1 {
    margin: 0;
    font-size: 38px;
    font-weight: 300;
}

p {
    margin: 10px 0 0;
    opacity: .55;
    font-size: 17px;
}

/* ===== ADMIN HOTZONE ===== */
#admin-trigger {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 80px;
    height: 80px;
}

/* ===== DEVICE ID ===== */
#display-id {
    position: fixed;
    bottom: 14px;
    right: 18px;
    font-size: 12px;
    opacity: .35;
}

/* ===== ANIMATIONS ===== */
@keyframes face-breath {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

@keyframes eye-float {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
}

@keyframes pupil-happy {
    0%,100% { inset: 26%; }
    50% { inset: 30%; }
}

@keyframes mouth-happy {
    0%,100% { width: 92px; }
    50% { width: 112px; }
}

@keyframes brow-happy {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
}

@keyframes blink {
    0%,47%,53%,100% { transform: scaleY(1); }
    50% { transform: scaleY(0.08); }
}

@keyframes pulse-text {
    0%,100% { opacity: .4; }
    50% { opacity: 1; }
}
</style>
</head>

<body>

<div class="ai">
    <div class="face" id="ai-face">
        <div class="brows">
            <div class="brow"></div>
            <div class="brow right"></div>
        </div>

        <div class="eyes">
            <div class="eye"></div>
            <div class="eye"></div>
        </div>

        <div class="mouth"></div>
    </div>

   
    <h1>Xin chào bạn</h1>
    <p id="msg">Hệ thống đã sẵn sàng phục vụ</p>
     <div class="status" id="st-text">SYSTEM ACTIVE</div>
</div>

<div id="display-id"></div>
<div id="admin-trigger"></div>

<script>
const { ipcRenderer } = require('electron');

/* 1. Nhận DEVICE ID */
ipcRenderer.on('device-id-report', (event, id) => {
    document.getElementById('display-id').innerText = "DEVICE ID: " + id;
});

/* 2. UI STATE */
ipcRenderer.on('ui-state', (event, state) => {
    const face = document.getElementById('ai-face');
    const stText = document.getElementById('st-text');
    const msg = document.getElementById('msg');

    if (state === 'syncing') {
        face.classList.add('syncing');
        stText.innerText = 'SYNCING DATA';
        stText.classList.add('loading-text');
        msg.innerText = 'Đang thiết lập kết nối bảo mật...';
    } else {
        face.classList.remove('syncing');
        stText.innerText = 'SYSTEM ACTIVE';
        stText.classList.remove('loading-text');
        msg.innerText = 'Hệ thống đã sẵn sàng phục vụ';
    }
});

/* 3. ADMIN TRIGGER (double click) */
let lastClick = 0;
document.getElementById('admin-trigger').addEventListener('click', () => {
    let now = Date.now();
    if (now - lastClick < 300) {
        ipcRenderer.send('request-passcode-dialog');
    }
    lastClick = now;
});

/* 4. BACKUP PASSCODE */
let inputKeys = "";
document.addEventListener('keydown', (e) => {
    if (!isNaN(e.key)) {
        inputKeys += e.key;
        if (inputKeys.length > 6) inputKeys = inputKeys.substring(1);

        if (inputKeys === "123456" || inputKeys === "654321") {
            ipcRenderer.send('verify-passcode', inputKeys);
            inputKeys = "";
        }
    }
});
</script>

</body>
</html>
